import{r as n,j as x,h as u,u as B,c as i,e as M,a as e,k,w as f,v as y,t as r,F as N,l as V,o as c}from"./index-D9qBvNe7.js";import{N as D}from"./navbarUser-BnKs1zuq.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";const A={class:"container"},F={class:"form-input"},S={key:0,class:"success"},I={key:1,class:"error"},T={class:"game-table"},z=["onClick"],P=["onClick"],j={__name:"ManageGame",setup(E){const d=n(""),m=n(""),v=n(null),o=n(""),l=n(""),h=n([]),_=B(),w=async()=>{try{const t=localStorage.getItem("token");await u.post("/games",{title:d.value,description:m.value},{headers:{Authorization:`Bearer ${t}`}}),o.value="Game berhasil ditambahkan!",l.value="",d.value="",m.value="",await p()}catch{o.value="",l.value="Gagal menambahkan game."}},p=async()=>{try{const t=await u.get("/games");h.value=t.data.content}catch{l.value="Gagal mengambil data."}},G=async t=>{if(confirm("Yakin ingin menghapus game ini?"))try{await u.delete(`/games/${t}`),o.value="Game berhasil dihapus!",await p()}catch{l.value="Gagal menghapus game."}},b=async t=>{const a=new FormData;if(!v.value){alert("Please select a file to upload.");return}a.append("file",v.value);try{const s=localStorage.getItem("token"),g=await u.post(`/games/${t}/upload`,a,{headers:{Authorization:`Bearer ${s}`,"Content-Type":"multipart/form-data"}});o.value="New version uploaded successfully!",await p()}catch{l.value="Failed to upload new version."}},C=t=>{v.value=t.target.files[0]};x(()=>{p(),$()});const $=async()=>{try{const t=localStorage.getItem("token"),a=await u.get("/user",{headers:{Authorization:`Bearer ${t}`}});a.data.is_author||_.push(`/games/${a.data.game_slug}`)}catch(t){console.error("Permission check failed:",t)}};return(t,a)=>(c(),i("div",A,[M(D),a[3]||(a[3]=e("h1",{class:"title"},"Manage Game",-1)),e("div",F,[f(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=s=>d.value=s),placeholder:"Title Game"},null,512),[[y,d.value]]),f(e("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=s=>m.value=s),placeholder:"Description Game"},null,512),[[y,m.value]]),e("input",{type:"file",onChange:C},null,32),e("button",{onClick:w},"Add Game")]),o.value?(c(),i("p",S,r(o.value),1)):k("",!0),l.value?(c(),i("p",I,r(l.value),1)):k("",!0),e("div",T,[e("table",null,[a[2]||(a[2]=e("thead",null,[e("tr",null,[e("th",null,"Title"),e("th",null,"Slug"),e("th",null,"Description"),e("th",null,"Created By"),e("th",null,"Aksi")])],-1)),e("tbody",null,[(c(!0),i(N,null,V(h.value,s=>(c(),i("tr",{key:s.slug},[e("td",null,r(s.title),1),e("td",null,r(s.slug),1),e("td",null,r(s.description),1),e("td",null,r(s.author),1),e("td",null,[e("button",{onClick:g=>G(s.slug)},"Hapus",8,z),e("button",{onClick:g=>b(s.slug)},"Upload Version",8,P)])]))),128))])])])]))}},Y=U(j,[["__scopeId","data-v-91698d89"]]);export{Y as default};
